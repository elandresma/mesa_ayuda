<?php

class CtrlArea{
	var $objClsArea;

	function CtrlArea($objClsArea){
		$this->objClsArea=$objClsArea;
	}

	function Guardar(){

		$idArea=$this->objClsArea->getIdArea();
		$nombre=$this->objClsArea->getNombre();
		$fkEmpleado=$this->objClsArea->getFkEmpleado();
		

		$objCon = new Conexion();//instancia clase conexion

		$comSql="INSERT INTO AREA VALUES(".$idArea.",'".$nombre."',".$fkEmpleado.")";

        $enl=$objCon->conectar("localhost","MESA_AYUDA","root","");//enviar un mensaje, ejectar un metodo
        $objCon->ejecutarSql("MESA_AYUDA",$comSql);
        $objCon->cerrar($enl);
	}

	function Actualizar(){
		$idArea=$this->objClsArea->getIdArea();
		$nombre=$this->objClsArea->getNombre();
		$fkEmpleado=$this->objClsArea->getFkEmpleado();;

		$objCon = new Conexion();//instancia clase conexion

		$comSql="UPDATE AREA SET NOMBRE ='".$nombre."', FKEMPLE =".$fkEmpleado." WHERE IDAREA=".$idArea."";

		$enl=$objCon->conectar("localhost","MESA_AYUDA","root","");//enviar un mensaje, ejectar un metodo
        $objCon->ejecutarSql("MESA_AYUDA",$comSql);
        $objCon->cerrar($enl);
	}



	function Eliminar(){
		$idArea=$this->objClsArea->getIdArea();

		$objCon = new Conexion();//instancia clase conexion

		$comSql="DELETE FROM AREA  WHERE IDAREA=".$idArea."";

		$enl=$objCon->conectar("localhost","MESA_AYUDA","root","");//enviar un mensaje, ejectar un metodo
        $objCon->ejecutarSql("MESA_AYUDA",$comSql);
        $objCon->cerrar($enl);
	}

	function Consultar(){
		$idArea=$this->objClsArea->getIdArea();
		$objCon = new Conexion();

		$comSql="SELECT * FROM AREA WHERE IDAREA='$idArea'";

        
		
		$enl=$objCon->conectar("localhost","MESA_AYUDA","root","");//enviar un mensaje, ejectar un metodo
        $recorSet=$objCon->ejecutarSql("MESA_AYUDA",$comSql);

		if($recorSet){
		$fila= mysql_fetch_array($recorSet);

		$nombre= $fila[1];
		$fkEmpleado= $fila[2];


		$this->objClsArea->setNombre($nombre);
		$this->objClsArea->setFkEmpleado($fkEmpleado);
		
		}
		$objCon->cerrar($enl);
		
		return $objClsArea;
	}

	function ConsultarComboBox(){
	
		$objCon = new Conexion();

		$comSql="SELECT IDEMPLEADO,NOMBRE FROM EMPLEADO";

		$enl=$objCon->conectar("localhost","mesa_ayuda","root","");//enviar un mensaje, ejectar un metodo
		$recorSet=$objCon->ejecutarSql("mesa_ayuda",$comSql);
		
		
		if ($recorSet) //si la variable tiene al menos 1 fila entonces seguimos con el codigo
		{
			$row= mysql_fetch_array($recorSet);
			$combobit="";
			while ($row = $recorSet->fetch_array($comSql)) 
			{
				$combobit .='<option value="'.$row[0].'">'.$row[1].'</option>'; //concatenamos el los options para luego ser insertado en el HTML
			}
		}
		else
		{
			echo "No hubo resultados".$combobit;
			
		}
	/*	while ($row = $recorSet->fetch_array(MYSQLI_ASSOC)) 
		{

		$fkEmpleado .=" <option value=\"{$row[0]}\">{$row['NOMBRE']}</option>"; 
		}
*/
		
		$objCon->cerrar($enl);
		
		return $combobit;
	}


}
?>
